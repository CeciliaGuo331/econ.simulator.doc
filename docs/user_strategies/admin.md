# 管理员操作指南

本指南面向系统维护与教学运营人员，帮助你熟悉 Econ Simulator 管理员界面的主要功能、操作流程，以及仿真实例设置中各项参数的含义。

## 1. 管理员登录入口

1. 打开浏览器访问部署好的 Econ Simulator 后台，例如：`https://your-domain/web/login`。
2. 使用管理员帐户邮箱与密码登录。
3. 登录后会自动跳转至管理员仪表盘。

> 管理员账号无需加入仿真实例即可查看所有数据和执行运维操作。

## 2. 仪表盘主要区域

管理员仪表盘由以下板块组成：

| 区域 | 说明 |
| --- | --- |
| **管理员中心** | 显示当前选中的仿真实例 ID、脚本额度、状态提示。 |
| **仿真实例管理** | 创建、选择、删除仿真实例；调整脚本上限；执行 Tick、自动运行若干天、重置世界状态；配置家户冲击。 |
| **世界状态快照** | 展示当前世界的 JSON 状态，便于快速排查策略输出。 |
| **用户管理** | 查看注册用户及其角色、注册时间，支持删除用户。 |
| **脚本管理** | 查看所有上传的脚本、所属仿真实例及上传时间，支持删除脚本。 |

## 3. 仿真实例管理操作

### 3.1 创建或切换仿真实例

- **创建仿真实例**：在“新仿真实例 ID”输入框留空可自动生成 ID，也可手动填写自定义 ID，点击“创建仿真实例”。
- **切换仿真实例**：点击表格左侧的仿真实例 ID 即可在仪表盘中切换，粗体表示当前选中实例。

> 仿真实例列表中的“挂载家户脚本数”列展示当前实例下已挂载脚本的家户数量（按邮箱去重，仅统计 `individual` 角色）。删除脚本后该统计会实时更新，便于管理员确认实际参与的家户脚本规模。

### 3.2 调整脚本上限

每个仿真实例可以单独设置“每位用户允许上传的脚本数量”。

1. 在“脚本上限”列输入目标上限（正整数）。
2. 点击“保存”应用；点击“清除”恢复为无限制。

若已有用户脚本数量超过设置上限，保存时会提示失败，需要先删除多余脚本。

### 3.3 手动执行 Tick

- **执行 Tick**：立即推进一次仿真 Tick。执行完成后页面会显示成功信息与最新 Tick/Day。
- **自动执行**：在输入框中填写需要推进的天数，点击“自动执行”，系统会后台异步运行，对应按钮会显示执行中状态；完成后页面会自动刷新。

### 3.4 重置或删除仿真实例

- **重置**：将当前仿真实例恢复为初始世界状态，同时保留已选功能开关和参数。
- **删除**：彻底删除仿真实例，解除与参与者、脚本的挂载关系。删除后若仍在该实例页面，系统会自动跳转到其他实例或默认视图。

## 4. 家户异质性冲击设置

表格“操作”区域第二行展示“保存冲击”面板，控制是否启用家户异质性冲击及其参数。

| 控件 | 说明 |
| --- | --- |
| **启用** | 选中后激活家户能力/资产冲击逻辑；取消选中则下一 Tick 起不再生成家户冲击，并清空现存冲击数据。 |
| **σ能力（household_shock_ability_std）** | 家户能力冲击的标准差。单位为抽象能力值，不可为负；值越大，家户在当 Tick 中的劳动供给能力波动越明显。 |
| **β资产（household_shock_asset_std）** | 家户资产冲击强度系数。用于放大或缩小资产冲击的方差；0 表示无资产冲击。 |
| **冲击上限（household_shock_max_fraction）** | 限制单个家户当 Tick 资产冲击对其现金的最大影响比例（0 ~ 0.9 建议）。例如 0.4 表示冲击不会让家户现金下降超过 40%。 |

> **提示**：留空任意参数表示保持当前值不变；保存时系统会自动校验参数范围。资产冲击总量在每 Tick 内保持为 0，以确保宏观上资产守恒。

## 5. 世界状态快照

- 快照展示当前仿真假设世界的详细数据，包括 Tick、Day、各类主体状态。
- 可复制 JSON 内容进行离线分析或提交给研发团队排查问题。

## 6. 用户与脚本管理

### 6.1 用户管理

- **查看用户**：列表显示每位用户邮箱、角色、注册时间、上传脚本数量。当前管理员账号会在列表中标记为“当前账号”。
- **删除用户**：点击“删除”可移除选中用户及其名下脚本。

### 6.2 脚本管理

- **脚本信息**：显示脚本 ID、版本号、挂载的仿真实例、上传者与描述。
- **删除脚本**：点击“删除”可移除指定脚本。如该脚本已挂载至仿真实例，会同步解绑。

## 7. 下载日志

在顶部“调试工具”面板中，选择目标仿真实例后可下载最近执行日志文件，方便追踪后台任务或策略输出情况。

## 8. 常见问题 (FAQ)

### 8.1 页面显示的参数没有更新

- 检查是否勾选“启用冲击”以及是否点击“保存冲击”。
- 刷新浏览器（Command+Shift+R）以清除缓存。

### 8.2 自动执行任务排队无法立即启动

- 同一仿真实例同时只能有一个后台自动运行任务。稍候片刻或确认没有正在执行的另一任务。

### 8.3 创建仿真实例失败

- 检查输入的仿真实例 ID 是否已存在或包含非法字符。
- 查看页面顶部错误信息获取具体原因。

如需更多信息或遇到异常，请联系研发团队并附上当前仿真实例 ID、操作步骤、日志文件。
